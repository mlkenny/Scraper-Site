{% extends 'partials/base.html' %}

{% block title %}Scraping{% endblock %}

{% block content %}
<div class="container py-5">

    <!-- Header -->
    <div class="text-center mb-4">
        <h2>Scraped Quotes for <strong>{{ character.name }}</strong></h2>
        <h5 class="text-muted">Scraping Time: {{ scrape_time }} seconds</h5>
    </div>


    <!-- Quotes Section -->
    <div class="card shadow-sm mb-5">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0">Extracted Quotes</h4>
        </div>

        <div class="card-body" style="max-height: 350px; overflow-y: auto;">
            {% if quotes %}
            <ul class="list-group">
                {% for q in quotes %}
                <li class="list-group-item">
                    <small class="text-muted">{{ q.source_url }}</small><br>
                    ‚Äú{{ q.quote }}‚Äù
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p class="text-muted">No quotes available for this character.</p>
            {% endif %}
        </div>
    </div>


    <!-- Metrics Section -->
    <div class="card shadow-sm mb-5">
        <div class="card-header bg-dark text-white">
            <h4 class="mb-0">Scraping Metrics</h4>
        </div>
        <div class="card-body">
            {% if metrics %}
            <table class="table table-striped table-bordered mb-0">
                <tr>
                    <th>Total URLs Discovered</th>
                    <td>{{ metrics.total_urls_discovered }}</td>
                </tr>
                <tr>
                    <th>Safe Quotes Extracted</th>
                    <td>{{ metrics.safe_quotes_extracted }}</td>
                </tr>
                <tr>
                    <th>Unsafe Quotes Extracted</th>
                    <td>{{ metrics.unsafe_quotes_extracted }}</td>
                </tr>
                <tr>
                    <th>Unique Quotes</th>
                    <td>{{ metrics.unique_quotes }}</td>
                </tr>
                <tr>
                    <th>Scrape Duration (seconds)</th>
                    <td>{{ metrics.scrape_duration }}</td>
                </tr>
                <tr>
                    <th>Timestamp</th>
                    <td>{{ metrics.timestamp }}</td>
                </tr>
            </table>
            {% else %}
            <p class="text-muted">No metrics available.</p>
            {% endif %}
        </div>
    </div>

    <div class="mt-4">
        <a href="{% url 'home' %}" class="btn btn-secondary">
            ‚¨Ö Back to Character Selection
        </a>

        <a href="{% url 'train_model' %}?character={{ character }}&time_taken={{ scrape_time }}" class="btn btn-primary me-2">
            üöÄ Train Model
        </a>
    </div>

</div>
{% endblock %}